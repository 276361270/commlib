<div class="row-fluid" id="module-content-{$type}">
<div class="row-fluid">
<script type="text/javascript">
$(function(){
    $("#id").val("{$module}");

$('#{$type}btn-query').click(function(){
    var link=$(this).data('href');
    var para=$('#id').val();
    if(!link)return false;
    $.ajax({
        url: link,
        dataType: "html",
        type: "POST",
        data:{id:para},
        cache: false,
        async:true,
        success: function(html){
            $("#module-content-{$type}").replaceWith(html);
            return false;
        }
    });
    return false;
});
}); 
</script>
<form class="form-inline">
    表名 <select id="id" name="id" class="span2">
        <volist name="Modules" id="vo">
            <option value ="{$vo}">{$vo}</option>
        </volist>
    </select>
    <a data-href="{:U('edit')}" id="{$type}btn-query" class="btn"><i class="icon-search"></i></a>
    <a data-href="{:U('refer')}" id="btn-view" class="btn"><i class="icon-random"></i></a>
    <a data-href="{:U('index')}" id="btn-build" class="btn"><i class="icon-download"></i></a> 
    <a href="{:U('show')}" data-target="#add-modal" role="button" data-toggle="modal" data-original-title="Refer" rel="tooltip" data-placement="bottom" class="btn"><i class="icon-plus-sign"></i></a>
    <a data-href="{:U('index')}" id="btn-refresh" class="btn"><i class="icon-refresh"></i></a>
</form>
</div>
<div class="row-fluid">
<form class="" action="{:U('save')}" method="POST">
<div class="row-fluid">
    分组 <select id="group" name="group" class="span2">
    <volist name="group" id="vo">
        <option value ="{$vo}">{$vo}</option>
    </volist>
    </select>
    模块 <input type="text" name="module" value="{$module}" class="span2"/>
    <input type="hidden" name="name" value="{$module}" class="span2"/>
</div>
   <!--
    <table  class="table table-condensed table-bordered table-striped table-hover">
        <thead>
             <tr><th>外键</th>
                <th>引用表名</th>
                <th>引用字段</th>
                <th>显示字段</th>
                <th>fk</th>
                <th>引用类型</th>
                <th>字段列表</th>
            <tr>
        </thead>
        <tbody>
            <tr>
                <td>userid</td>
                <td>user</td>
                <td>id</td>
                <td>username</td>
                <td></td>
                <td>inner</td>
                <td>age,sex,nick_name</td>
            </tr>
            <tr>
                <td>catid</td>
                <td>catgory</td>
                <td>id</td>
                <td>name</td>
                <td></td>
                <td>inner</td>
                <td></td>
            </tr>
        </tbody>
    </table>
-->

    <table  class="table table-condensed table-bordered table-striped table-hover">
        <thead>
             <tr><th>外键</th>
                <th>引用表名</th>
                <th>引用字段</th>
                <th>显示字段</th>
                <th>fk</th>
                <th>引用类型</th>
                <th>字段列表</th>
            <tr>
        </thead>
        <tbody>
            <tr>
                <td>userid</td>
                <td>user</td>
                <td>id</td>
                <td>username</td>
                <td></td>
                <td>inner</td>
                <td>age,sex,nick_name</td>
            </tr>
            <tr>
                <td>catid</td>
                <td>catgory</td>
                <td>id</td>
                <td>name</td>
                <td></td>
                <td>inner</td>
                <td></td>
            </tr>
        </tbody>
    </table>

<table  class="table table-condensed table-bordered table-striped table-hover" id="data-table">
    <thead>
        <tr>
            <th colspan="4">字段</th>
            <th colspan="3">列表</th>
            <th colspan="6">添加</th>
        </tr>
        <tr>
            <th>引用</th>
            <th>名称</th>
            <th>标题</th>
            <th>类型</th>
            <th>查询</th>
            <th>显示</th>
            <th>顺序</th>
            <th>表单类型</th>
            <th>显示</th>
            <th>顺序</th>
            <th>前台验证</th>
            <th>后台验证</th>
            <th>默认提示</th>
        <tr>
    </thead>
    <tbody>
        <volist name="data" id="vo">
        <tr><td><a href='{:U("refer","module=$module&pk=".$data[0]["Field"]."&fk=".$vo["Field"])}' data-target="#add-modal" role="button" data-toggle="modal" data-original-title="Refer" rel="tooltip" data-placement="bottom" class=""><i class="icon-random"></i></a></td>
            <td>{$vo.Field}<input class="input-mini" type="hidden" name="query[{$vo.Field}][field]" value="{$vo.Field}" /></td>
            <td><input class="input-mini" type="text" name="query[{$vo.Field}][title]" value="{$vo.Comment}" /></td>
            <td>{$vo.Type}<input class="input-mini" type="hidden" name="query[{$vo.Field}][type]" value="{$vo.Type}" /></td>
            <td><input name="query[{$vo.Field}][query_able]" type="checkbox" ></td>
            <td><input name="query[{$vo.Field}][list_show]" type="checkbox" checked></td>
            <td><input class="input-min input-mini" type="text" name="query[{$vo.Field}][list_order]" value="{$i}" /></td>
            <td>
                <select name="query[{$vo.Field}][control_type]" class="span12">
                    <option value ="text" <php>echo (strpos($vo['Type'],'varchar')!==false) && ($vo['Key']!=='PRI')?'selected':'';</php>>文本框</option>
                    <option value ="area" <php>echo strpos($vo['Type'],'text')!==false?'selected':'';</php> >多行文本框</option>
                    <option value ="select" <php>echo strpos($vo['Type'],'enum')!==false?'selected':'' </php> >列表框</option>
                    <option value ="date" <php>echo strpos($vo['Type'],'datetime')!==false?'selected':'';</php> >日期控件</option>
                    <option value ="checkbox" <php>echo strpos($vo['Type'],'bit')!==false?'selected':'';</php> >复选框</option>
                    <option value ="digit" <php>echo ((strpos($vo['Type'],'int')!==false) && ($vo['Key']!=='PRI'))?'selected':'';</php> >数字输入框</option>
                    <option value ="hidden" <php>echo $vo['Key']==='PRI'?'selected':'';</php>>隐藏控件</option>
                </select>
            </td>
            <td><input name="query[{$vo.Field}][add_show]" type="checkbox" checked></td>
            <td><input class="input-min input-mini" type="text" name="query[{$vo.Field}][add_order]" value="{$i}" /></td>
            <td><input class="input-mini" type="text" name="query[{$vo.Field}][validator]" value="{:validator($vo);}" /></td>
            <td><input class="input-mini" type="text" name="query[{$vo.Field}][auto]" value="{$vo.auto}" /></td>
            <td><input class="input-min" type="text" name="query[{$vo.Field}][tips]" value="{$vo.tips}" /></td>
        </tr>
        </volist>
    </tbody>
</table>
   <include file="./Tpl/Comm/Index/btn.html"/>
</form>
</div>
<include file="./Tpl/Comm/Moudle/add.html"/>
</div>
